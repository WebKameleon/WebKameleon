{with:gmapWidget}
<script type="text/javascript" src="{widget_images}/widget.js" ></script>
<script type="text/javascript" src="{widget_images}/edit.js" ></script>
<script src="//maps.google.com/maps/api/js?sensor=true{if:data.key}&key={data.key}{endif:data.key}" type="text/javascript"></script>

<form method="post" id="mapForm">
    {include:_widget.header.html}
    
    <div class="edit_box">
        <div class="label">{translate.Search address}</div>
        <div class="value">
            <input type="text" value="" id="km_w2_adres" />
            <a id="szukaj_adresu" class="normal_button">{translate.Search}</a>
        </div>
    </div>    
    <div id="km_w2" style="width: 100%; height: 400px;"></div>

    
    <div class="edit_box" id="liopt_in_options_marker">
        <div class="label">{translate.Show marker on the map}:</div>
        <div class="value">
            <input type="hidden" name="gmap[marker]" value="0"/>
            <input {if:data.marker}checked{endif:data.marker} class="k_checkbox" type="checkbox" name="gmap[marker]"
                   onclick="document.getElementById('liopt_in_options_icon').style.display=this.checked?'block':'none'" value="1"/>
        </div>
    </div>
    
    <div class="edit_box" id="liopt_in_options_icon" {if:!data.marker}style="display:none;"{endif:!data.marker}>
        <div class="label">{translate.Icon}:</div>
        <div class="value">
            <input name="td[img]" style="width:250px" value="{td.img}" class="k_input" type="text" files="1"/>
        </div>
    </div>
    
    <div class="edit_box" id="liopt_in_options_title">
        <div class="label">{translate.Title}:</div>
        <div class="value">
            <input id="in_options_title" name="gmap[title]" style="width:600px" value="{data.title}" class="k_input" type="text" />
        </div>
    </div>    

    <div class="edit_box" id="liopt_in_options_type">
        <div class="label">{translate.Type}:</div>
        <div class="value">
            <select class="k_select" style="" name="gmap[type]">
                <option {if:data.type=hybrid}selected{endif:data.type=hybrid} value="hybrid">{translate.hybrid}</option>
                <option {if:data.type=satellite}selected{endif:data.type=satellite} value="satellite">{translate.satellite}</option>
                <option {if:data.type=roadmap}selected{endif:data.type=roadmap} value="roadmap">{translate.roadmap}</option>
                <option {if:data.type=terrain}selected{endif:data.type=terrain} value="terrain">{translate.terrain}</option>
            </select>
        </div>
    </div>
    <div class="edit_box" id="liopt_in_options_width">
        <div class="label">{translate.Width}(px):</div>
        <div class="value">
            <input id="in_options_width" name="gmap[width]" style="width:100px" value="{data.width}" class="k_input" type="text" />
        </div>
    </div>
    <div class="edit_box" id="liopt_in_options_height">
        <div class="label">{translate.Height}(px):</div>
        <div class="value">
            <input id="in_options_height" name="gmap[height]" style="width:100px" value="{data.height}" class="k_input" type="text" />
        </div>
    </div>
    <div class="edit_box" id="liopt_in_options_lat">
        <div class="label">{translate.Latitiude}:</div>
        <div class="value">
            <input id="in_options_lat" name="gmap[lat]" style="width:150px" value="{data.lat}" class="k_input" type="text" />
        </div>
    </div>
    <div class="edit_box" id="liopt_in_options_lng">
        <div class="label">{translate.Longitude}:</div>
        <div class="value">
            <input id="in_options_lng" name="gmap[lng]" style="width:150px" value="{data.lng}" class="k_input" type="text" />
        </div>
    </div>
    <div class="edit_box" id="liopt_in_options_zoom">
        <div class="label">{translate.Zoom}:</div>
        <div class="value">
            <select class="k_select" style="width:100px" name="gmap[zoom]">
                <option value="">{translate.Choose}</option>
                <option {if:data.zoom=1}selected{endif:data.zoom=1} value="1">1</option>
                <option {if:data.zoom=2}selected{endif:data.zoom=2} value="2">2</option>
                <option {if:data.zoom=3}selected{endif:data.zoom=3} value="3">3</option>
                <option {if:data.zoom=4}selected{endif:data.zoom=4} value="4">4</option>
                <option {if:data.zoom=5}selected{endif:data.zoom=5} value="5">5</option>
                <option {if:data.zoom=6}selected{endif:data.zoom=6} value="6">6</option>
                <option {if:data.zoom=7}selected{endif:data.zoom=7} value="7">7</option>
                <option {if:data.zoom=8}selected{endif:data.zoom=9} value="8">8</option>
                <option {if:data.zoom=9}selected{endif:data.zoom=9} value="9">9</option>
                <option {if:data.zoom=10}selected{endif:data.zoom=10} value="10">10</option>
                <option {if:data.zoom=11}selected{endif:data.zoom=11} value="11">11</option>
                <option {if:data.zoom=12}selected{endif:data.zoom=12} value="12">12</option>
                <option {if:data.zoom=13}selected{endif:data.zoom=13} value="13">13</option>
                <option {if:data.zoom=14}selected{endif:data.zoom=14} value="14">14</option>
                <option {if:data.zoom=15}selected{endif:data.zoom=15} value="15">15</option>
                <option {if:data.zoom=16}selected{endif:data.zoom=16} value="16">16</option>
                <option {if:data.zoom=17}selected{endif:data.zoom=17} value="17">17</option>
                <option {if:data.zoom=18}selected{endif:data.zoom=18} value="18">18</option>
                <option {if:data.zoom=19}selected{endif:data.zoom=19} value="19">19</option>
                <option {if:data.zoom=20}selected{endif:data.zoom=20} value="20">20</option>
                <option {if:data.zoom=21}selected{endif:data.zoom=21} value="21">21</option>
            </select>
        </div>
    </div>
    <div class="edit_box" id="liopt_in_options_link">
        <div class="label">{translate.Link to Google Maps}:</div>
        <div class="value">
            <input id="in_options_link" name="gmap[link]" style="width:600px" value="{data.link}" class="k_input" type="text" />
        </div>
    </div>

    <div class="edit_box" id="liopt_in_options_key">
        <div class="label">{translate.Key}:</div>
        <div class="value">
            <input id="in_options_lng" name="gmap[key]" style="width:300px" value="{data.key}" class="k_input" type="text" />
        </div>
    </div>

</form>

<script type="text/javascript">
function SaveChanges()
{
    document.getElementById('mapForm').submit();
    return false;
}

function checkGeo()
{

{if:!data.__saved__}
if (navigator.geolocation)
{
    navigator.geolocation.getCurrentPosition(function (position){
        
        var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        km_w2_mapa.setCenter(pos);
        km_w2_marker.setPosition(pos);
        
        jQueryKam('#in_options_lat').val(position.coords.latitude);
        jQueryKam('#in_options_lng').val(position.coords.longitude);

    
    });
}
{endif:!data.__saved__}
}
</script>
{endwith:gmapWidget}
